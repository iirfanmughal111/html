!function(o,a){XF.Groups_EventMap=XF.Element.newHandler({options:{zoom:null,place:null,acfield:null,error:null},$address:null,$map:null,$latitude:null,$longitude:null,map:null,markers:[],init:function(){this.$address=o(this.options.acfield),this.$latitude=o('input[name="latitude"]'),this.$longitude=o('input[name="longitude"]'),this.$map=this.$target.find(">.map"),this.createMap();var t=new google.maps.LatLng(this.$latitude.val()||0,this.$longitude.val()||0),e=(this.map.setCenter(t),this.addMarkerToMap(t),this),n=(this.geocoder=new google.maps.Geocoder,new google.maps.places.Autocomplete(this.$address[0],{type:["geocode"]}));n.addListener("place_changed",function(){var t=n.getPlace();e.removeMarkers(),e.map.setCenter(t.geometry.location),e.addMarkerToMap(t.geometry.location),e.updateLatLng(t.geometry.location)})},createMap:function(){this.map=new google.maps.Map(this.$map[0],{zoom:this.options.zoom}),google.maps.event.addListener(this.map,"click",o.proxy(this,"addMarker"))},addMarker:function(t){this.removeMarkers();t=t.latLng;this.geocoder.geocode({latLng:t},o.proxy(this,"geocoderReponse")),this.updateLatLng(t),this.addMarkerToMap(t)},geocoderReponse:function(t){if(!t.length)return XF.alert(this.options.error),!1;t=t[0];this.$address.val(t.formatted_address)},addMarkerToMap:function(t){t=new google.maps.Marker({position:t,map:this.map,draggable:!1,animation:google.maps.Animation.DROP});this.markers.push(t)},removeMarkers:function(){for(var t=0;t<this.markers.length;t++)this.markers[t].setMap(null)},updateLatLng:function(t){this.$latitude.val(t.lat()),this.$longitude.val(t.lng())}}),XF.Groups_CountDown=XF.Element.newHandler({options:{time:null,classPrefix:null},$days:null,$hours:null,$minutes:null,$seconds:null,cached:{},init:function(){var t,e;function n(){e.interval=setInterval(XF.proxy(e,"onTick"),1e3)}this.options.time&&(t=this.options.classPrefix,this.$days=this.$target.find(t+"days"),this.$hours=this.$target.find(t+"hours"),this.$minutes=this.$target.find(t+"minutes"),this.$seconds=this.$target.find(t+"seconds"),this.onTick(),e=this,n(),o(a).on("blur",function(){clearInterval(e.interval)}),o(a).on("focus",n))},onTick:function(){var t,e,n,o=1e3*this.options.time,o=new Date(o),o=Math.ceil((o.getTime()-Date.now())/1e3);o<=0&&clearInterval(this.interval),o=o=(o=(o-=86400*(t=Math.floor(o/86400)))-3600*(e=Math.floor(o/3600)))-60*(n=Math.floor(o/60)),this.update(this.$days,"days",t),this.update(this.$hours,"hours",e),this.update(this.$minutes,"minutes",n),this.update(this.$seconds,"seconds",o)},update:function(t,e,n){this.cached[e]!==n&&(t.find(this.options.classPrefix+"number").text(n),this.cached[e]=n)}}),XF.Groups_EventFulCalendar=XF.Element.newHandler({options:{source:null,buttonToday:null,buttonMonth:null,buttonWeek:null,buttonDay:null,buttonList:null},calendar:null,init:function(){this.setupCalendar()},setupCalendar:function(){var t=new FullCalendar.Calendar(this.$target[0],{initialView:"dayGridWeek",headerToolbar:{center:"dayGridMonth,dayGridWeek,listWeek"},events:{url:this.options.source,method:"GET",extraParams:{_xfWithData:1,_xfResponseType:"json",_xfToken:XF.config.csrf},failure:function(t){XF.defaultAjaxSuccessError(JSON.parse(t.xhr.response),t.xhr.status,t.xhr)}},height:650,buttonText:{today:this.options.buttonToday,month:this.options.buttonMonth,week:this.options.buttonWeek,day:this.options.buttonDay,list:this.options.buttonList},navLinks:!0});t.render(),t.on("eventDrop",XF.proxy(this,"onEventDrop")),this.calendar=t},onEventDrop:function(o){var t=o.event,e=o.delta;t.extendedProps.hasOwnProperty("editLink")&&t.extendedProps.editLink&&XF.ajax("POST",t.extendedProps.editLink,e,function(t,e,n){t.hasOwnProperty("is_saved")&&t.is_saved||o.revert(),XF.defaultAjaxSuccessError(t,e,n)},{skipDefault:!0})}}),XF.Element.register("tlg-event-map","XF.Groups_EventMap"),XF.Element.register("tlg-event-countdown","XF.Groups_CountDown"),XF.Element.register("tlg-event--fullcalendar","XF.Groups_EventFulCalendar")}(jQuery,this,document);