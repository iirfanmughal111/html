<xf:title>{{ phrase('z61_classifieds_add_listing_to...') }}</xf:title>

<xf:macro name="category_list" arg-children="{$categoryTree}" arg-extras="{$categoryExtras}" />

<xf:macro name="category_list" arg-children="!" arg-extras="!"  arg-depth="0">
	<xf:foreach loop="$children" key="$id" value="$child">
		<xf:macro name="category_list_entry"
			arg-category="{$child.record}" arg-extras="{$extras.{$id}}"
			arg-children="{$child.children}" arg-childExtras="{$extras}"
			arg-depth="{$depth}" />
	</xf:foreach>
</xf:macro>

<xf:macro name="category_list_entry" arg-category="!" arg-extras="!" arg-children="!" arg-childExtras="!" arg-depth="0">
	<xf:if is="$depth == 0">
		<xf:if is="$category.canAddListing()">
			<xf:macro name="category_list_entry_forum_level_0"
				arg-category="{$category}"
				arg-extras="{$extras}"
				arg-children="{$children}"
				arg-childExtras="{$childExtras}"
				arg-depth="{$depth}" />
		<xf:else />
			<xf:macro name="category_list_entry_no_posting_level_0"
				arg-category="{$category}"
				arg-extras="{$extras}"
				arg-children="{$children}"
				arg-childExtras="{$childExtras}"
				arg-depth="{$depth}" />
		</xf:if>
	<xf:else />
		<xf:if is="$category.canAddListing()">
			<xf:macro name="category_list_entry_forum"
				arg-category="{$category}"
				arg-extras="{$extras}"
				arg-children="{$children}"
				arg-childExtras="{$childExtras}"
				arg-depth="{$depth}" />
		<xf:else />
			<xf:macro name="category_list_entry_no_posting"
				arg-category="{$category}"
				arg-extras="{$extras}"
				arg-children="{$children}"
				arg-childExtras="{$childExtras}"
				arg-depth="{$depth}" />
		</xf:if>
	</xf:if>
</xf:macro>

<xf:macro name="category_list_entry_category_level_0"
	arg-category="!"
	arg-extras="!"
	arg-children="!"
	arg-childExtras="!"
	arg-depth="0">

	<div class="block block--treeEntryChooser">
		<div class="block-container">
			<h2 class="block-header">
				{$category.title}
				<xf:if is="$category.description">
					<span class="block-desc">
						{$category.description|strip_tags}
					</span>
				</xf:if>
			</h2>
			<div class="block-body">
				<xf:macro name="category_list"
					arg-children="{$children}" arg-extras="{$childExtras}" arg-depth="{{ $depth + 1 }}" />
			</div>
		</div>
	</div>
</xf:macro>

<xf:macro name="category_list_entry_forum_level_0"
	arg-category="!"
	arg-extras="!"
	arg-children="!"
	arg-childExtras="!"
	arg-depth="0">

	<div class="block block--treeEntryChooser">
		<div class="block-container">
			<xf:macro name="category_list_entry_forum"
				arg-category="{$category}"
				arg-extras="{$extras}"
				arg-children="{$children}"
				arg-childExtras="{$childExtras}"
				arg-depth="{$depth}" />
		</div>
	</div>
</xf:macro>

<xf:macro name="category_list_entry_no_posting_level_0"
	arg-category="!"
	arg-extras="!"
	arg-children="!"
	arg-childExtras="!"
	arg-depth="0">

	<div class="block block--treeEntryChooser">
		<div class="block-container">
			<xf:macro name="category_list_entry_no_posting"
				arg-category="{$category}"
				arg-extras="{$extras}"
				arg-children="{$children}"
				arg-childExtras="{$childExtras}"
				arg-depth="{$depth}" />
		</div>
	</div>
</xf:macro>

<xf:macro name="category_list_entry_forum"
	arg-category="!"
	arg-extras="!"
	arg-children="!"
	arg-childExtras="!"
	arg-depth="0">

	<div class="block-row block-row--clickable block-row--separated fauxBlockLink">
		<div class="contentRow contentRow--alignMiddle{{ $depth > 1 ? ' u-depth' . ($depth - 1) : '' }}">
			<div class="contentRow-main">
				<h2 class="contentRow-title">
					<a href="{{ link('classifieds/categories/add', $category) }}" class="fauxBlockLink-blockLink">
						{$category.title}
					</a>
				</h2>
				<xf:if is="$category.description">
					<div class="contentRow-minor contentRow-minor--singleLine">
						{$category.description|strip_tags}
					</div>
				</xf:if>
			</div>
			<div class="contentRow-suffix">
				<dl class="pairs pairs--rows pairs--rows--centered">
					<dt>{{ phrase('z61_classifieds_listings') }}</dt>
					<dd>{$extras.listing_count|number_short}</dd>
				</dl>
			</div>
		</div>
	</div>
	<xf:macro name="category_list"
		arg-children="{$children}" arg-extras="{$childExtras}" arg-depth="{{ $depth + 1 }}" />
</xf:macro>

<xf:macro name="category_list_entry_no_posting"
	arg-category="!"
	arg-extras="!"
	arg-children="!"
	arg-childExtras="!"
	arg-depth="0">

	<div class="block-row block-row--separated">
		<div class="contentRow contentRow--alignMiddle{{ $depth > 1 ? ' u-depth' . ($depth - 1) : '' }} is-disabled">
			<div class="contentRow-main">
				<h2 class="contentRow-title">
					{$category.title}
				</h2>
                <div class="contentRow-minor contentRow-minor--singleLine">
                    {{ phrase('no_permission_to_post') }}
                </div>
			</div>
			<div class="contentRow-suffix">
				<dl class="pairs pairs--rows pairs--rows--centered">
					<dt>{{ phrase('classifieds_listings') }}</dt>
					<dd>{{ $extras.listing_count|number_short }}</dd>
				</dl>
			</div>
		</div>
	</div>
	<xf:macro name="category_list"
		arg-children="{$children}"
		arg-extras="{$childExtras}"
		arg-depth="{{ $depth + 1 }}" />
</xf:macro>