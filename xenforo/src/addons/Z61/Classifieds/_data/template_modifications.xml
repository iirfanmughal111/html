<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="admin" template="forum_edit" modification_key="z61_classifieds_forum_edit_replace_action_button" description="Adds option for replacing action button on forum view" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:option name="find_new" selected="$forum.find_new"
					label="{{ phrase('include_forum_in_find_new_threads') }}"
					hint="{{ phrase('if_disabled_messages_will_never_appear_in_find_new_threads') }}" />]]></find>
    <replace><![CDATA[$0
<xf:option name="z61c_replace_action_btn" selected="$forum.z61c_replace_action_btn"
					label="{{ phrase('z61_classifieds_replace_forum_action_button') }}"
					hint="{{ phrase('z61_classifieds_replace_forum_action_button_explain') }}" />]]></replace>
  </modification>
  <modification type="public" template="forum_view" modification_key="classifieds_forum_view_page_action" description="Optionally replaces add thread with add listing" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:button href="{{ link('forums/post-thread', $forum) }}" class="button--cta" icon="write">
		{{ phrase('post_thread') }}
	</xf:button>]]></find>
    <replace><![CDATA[<xf:if is="$forum.ClassifiedsCategories is not empty and $forum.z61c_replace_action_btn">
	<xf:include template="z61_classifieds_forum_view_page_action" />
	<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="admin" template="helper_criteria" modification_key="classifieds_helper_criteria_listing_count" description="Add the listing count criteria." execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:user:content_after_messages]-->]]></find>
    <replace><![CDATA[$0
<xf:option name="user_criteria[listing_count][rule]" value="listing_count" selected="{$criteria.listing_count}"
	label="{{ phrase('z61_classifieds_user_has_submitted_at_least_x_listings:') }}">
	<xf:numberbox name="user_criteria[listing_count][data][listings]" value="{$criteria.listing_count.listings}"
		size="5" min="0" step="1" />
</xf:option>
<xf:option name="user_criteria[feedback_count][rule]" value="feedback_count" selected="{$criteria.feedback_count}"
	label="{{ phrase('z61_classifieds_user_has_at_least_x_feedback:') }}">
	<xf:numberbox name="user_criteria[feedback_count][data][feedback]" value="{$criteria.feedback_count.feedback}"
		size="5" min="0" step="1" />
</xf:option>]]></replace>
  </modification>
  <modification type="public" template="member_macros" modification_key="z61_classifieds_member_macros_feedback" description="Adds feedback to member stat pairs" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:stat_pairs:below_trophies]-->]]></find>
    <replace><![CDATA[$0
<xf:include template="z61_classifieds_member_macros_feedback" />]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="z61_classifieds_member_view_tab" description="Adds classifieds feedback to profile tabs" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:tabs:end]-->]]></find>
    <replace><![CDATA[$0
<xf:include template="z61_classifieds_member_view_tab" />]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="z61_classifieds_member_view_tab_content" description="Adds classifieds feedback to profile tab content" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:tab_panes:end]-->]]></find>
    <replace><![CDATA[$0
<xf:include template="z61_classifieds_member_view_tab_content" />]]></replace>
  </modification>
  <modification type="public" template="message_macros" modification_key="z61_classifieds_message_macros_feedback" description="Adds feedback to user elements" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:if is="$extras.website && $user.Profile.website">
						<dl class="pairs pairs--justified">
							<dt>{{ phrase('website') }}</dt>
							<dd><a href="{$user.Profile.website}" rel="nofollow" target="_blank">{$user.Profile.website|url('host', phrase('visit_site'))}</a></dd>
						</dl>
					</xf:if>]]></find>
    <replace><![CDATA[$0
<xf:include template="z61_classifieds_message_macros_feedback" />]]></replace>
  </modification>
  <modification type="admin" template="style_property_template_messageUserElements" modification_key="z61_classifieds_style_property_messageUserElements" description="Adds feedback to user elements" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:option name="{$formBaseKey}[custom_fields]" selected="{$property.property_value.custom_fields}">
		{{ phrase('custom_fields') }}
	</xf:option>]]></find>
    <replace><![CDATA[$0
<xf:option name="{$formBaseKey}[z61ClassifiedsFeedbackBasic]" selected="{$property.property_value.z61ClassifiedsFeedbackBasic}">
	{{ phrase('z61_classifieds_classifieds_feedback') }}
</xf:option>]]></replace>
  </modification>
  <modification type="public" template="thread_view" modification_key="z61_classifieds_thread_view_insert" description="Insert the listing header into threads when appropriate." execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:content_top]-->]]></find>
    <replace><![CDATA[$0
<xf:include template="z61_classifieds_thread_insert" />]]></replace>
  </modification>
  <modification type="admin" template="tools_rebuild" modification_key="z61_classifiesd_tools_rebuild" description="Append classifieds rebuilds to the end of the rebuild caches system." execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:rebuild_bottom]-->]]></find>
    <replace><![CDATA[$0
<xf:include template="z61_classifieds_tools_rebuild" />]]></replace>
  </modification>
  <modification type="admin" template="user_edit" modification_key="z61_classifieds_user_edit_feedback" description="Add feedback amount to user edit" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:numberboxrow name="user[trophy_points]" value="{$user.trophy_points}" min="0"
						label="{{ phrase('trophy_points') }}" />]]></find>
    <replace><![CDATA[$0
<xf:include template="z61_classifieds_user_edit_feedback" />]]></replace>
  </modification>
  <modification type="public" template="whats_new_wrapper" modification_key="z61_classifieds_whats_new_wrapper_link" description="Add the &quot;new classifieds&quot; link to what's new pages." execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:links:after_thread]-->]]></find>
    <replace><![CDATA[$0
<xf:if is="$xf.visitor.canViewClassifieds()">
	<a class="{$baseClass} {{ $pageSelected == 'new_classifieds' ? {$selectedClass} : '' }}" href="{{ link('whats-new/classifieds') }}" rel="nofollow">{{ phrase('z61_classifieds_new_listings') }}</a>
</xf:if>]]></replace>
  </modification>
</template_modifications>
