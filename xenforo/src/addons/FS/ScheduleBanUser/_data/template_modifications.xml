<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="member_macros" modification_key="add_scheduleBanBtn" description="add_scheduleBanBtn" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[	<xf:if is="$user.canBan()">
		<a href="{{ link('members/ban', $user) }}" class="menu-linkRow" data-xf-click="overlay">
			<xf:if is="$user.is_banned">
				{{ phrase('edit_ban') }}
			<xf:else />
				{{ phrase('ban_member') }}
			</xf:if>
		</a>
	</xf:if>]]></find>
    <replace><![CDATA[		$0
			<xf:if is="!$user.is_banned && !$user.is_moderator && !$user.is_admin">
<xf:if is="$xf.visitor.is_moderator || $xf.visitor.is_admin">
		<a href="{{ link('scheduleBanUser/add', $user) }}" class="menu-linkRow" data-xf-click="overlay">
				{{ phrase('secheduleBan') }}
		</a>
	</xf:if>
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="fs_sch_add_in_profile_information_member_view" description="Adds a warning to the profile" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<ul class="tabPanes js-memberTabPanes">]]></find>
    <replace><![CDATA[<xf:if is="{$user.is_banned}">
	<xf:macro template="fs_sch_user_ban_macros" name="banInfo" arg-user="{$user}" />
</xf:if>
<xf:if is="$user.ScheduleBan.ban_date && !$user.is_banned">
	<xf:macro template="fs_sch_user_ban_macros" name="banInfoBeforeBanProfile" arg-user="{$user}" />
</xf:if>
$0]]></replace>
  </modification>
  <modification type="public" template="post_macros" modification_key="fs_sch_add_in_post_warning_post_macros" description="Add blocking warning" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<div class="message-userContent(.*)"/is]]></find>
    <replace><![CDATA[<xf:if is="$post.User.ScheduleBan.ban_date && !$post.User.is_banned">
	<xf:macro template="fs_sch_user_ban_macros" name="banInfoBeforeBan" arg-banDate="{$post.User.ScheduleBan}" />
</xf:if>
<xf:if is="{$post.User.is_banned}">
	<xf:macro template="fs_sch_user_ban_macros" name="messageInfo" />
</xf:if>
$0]]></replace>
  </modification>
</template_modifications>
